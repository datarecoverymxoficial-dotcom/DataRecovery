<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Copias de Seguridad en la Nube — Data Recovery</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    /* === Popup bonito (mismo estilo que en la otra página) === */
    .popup-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); display: none; align-items: center; justify-content: center; z-index: 999; }
    .popup { background: #fff; border-radius: 12px; padding: 2em; text-align: center; max-width: 350px; width: 90%; box-shadow: 0 4px 15px rgba(0,0,0,0.2); animation: popupIn .3s ease; }
    .popup h2 { color: #2563eb; margin-bottom: .5em; }
    .popup p  { color: #333; margin-bottom: 1em; }
    .popup button { background:#2563eb; color:#fff; border:0; padding:.6em 1.2em; border-radius:6px; cursor:pointer; font-size:1em; }
    .popup button:hover { background:#1e4fd1; }
    @keyframes popupIn { from { transform: scale(.8); opacity:0; } to { transform: scale(1); opacity:1; } }

    /* Honeypot oculto y accesible */
    .hp-wrap { position: absolute; left: -9999px; width: 1px; height: 1px; overflow: hidden; }
  </style>
</head>
<body>
<header class="site-header">
  <div class="container nav">
    <a class="brand" href="index.html">
      <img src="imagenes/logo.png" alt="" width="28" height="28">
      <span>Data Recovery</span>
    </a>
    <button class="nav-toggle" aria-expanded="false" aria-controls="menu">☰</button>
    <nav id="menu" class="menu" aria-label="Principal">
      <ul>
        <li><a href="index.html">Inicio</a></li>
        <li><a href="servicios.html" aria-current="page">Servicios</a></li>
        <li><a href="acerca.html">Acerca</a></li>
        <li><a href="contacto.html">Contacto</a></li>
      </ul>
    </nav>
  </div>
</header>

<main id="contenido">
  <section class="section">
    <div class="container">
      <h1>Copias de Seguridad en la Nube</h1>
      <p class="lead" style="color:#1f2937;max-width:70ch">
        Protege tu información con respaldos automáticos en la nube. Configuramos planes seguros para que accedas a tus archivos
        cuando los necesites y evites volver a pasar por una pérdida de datos.
      </p>

      <div class="service-intro" style="margin-top:16px;">
        <article class="card">
          <h3>Costos orientativos</h3>
          <ul class="list">
            <li>Diagnóstico y propuesta: <strong>$0</strong> (gratuito)</li>
            <li>Implementación inicial (setup): <strong>$1,200–$2,500 MXN</strong></li>
            <li>Cuota mensual del proveedor: <strong>desde $120–$400 MXN</strong> (según almacenamiento)</li>
            <li>Capacitación básica al usuario: incluida en el setup</li>
          </ul>
          <p class="help">Los costos varían según volumen de datos, número de equipos y proveedor elegido.</p>
        </article>
        <figure class="service-illustration">
          <img src="imagenes/serv_rec_n.png" alt="Respaldo en la nube" loading="lazy" decoding="async">
        </figure>
      </div>

      <h3 style="margin-top:20px;">Solicita tu presupuesto</h3>
      <!-- Form con Formspree + honeypot + origen + metadata de página -->
      <form class="form" id="form-presu"
            action="https://formspree.io/f/mnngoppk"
            method="POST">
        <!-- Identificador de esta página -->
        <input type="hidden" name="origen" value="respaldo_nube">
        <!-- Subject dinámico (se completa en JS) -->
        <input type="hidden" name="_subject" id="subject-field" value="Solicitud: Respaldo en la nube">
        <!-- Estimado en texto (se completa en JS) -->
        <input type="hidden" name="estimado_texto" id="estimado-field" value="">
        <!-- URL de la página (se completa en JS) -->
        <input type="hidden" name="page_url" id="page-url-field" value="">
        <!-- Imagen asociada a la página (referencia visual para ti) -->
        <input type="hidden" name="page_image" id="page-image-field" value="imagenes/serv_rec_n.png">

        <!-- Honeypot anti-spam (dejar vacío) -->
        <div class="hp-wrap" aria-hidden="true">
          <label>Dejar este campo vacío:
            <input type="text" name="campo_extra" tabindex="-1" autocomplete="off">
          </label>
        </div>

        <div class="grid-2">
          <label><span>Nombre</span><input name="nombre" required></label>
          <label><span>Correo</span><input name="correo" type="email" required></label>
        </div>

        <div class="grid-2">
          <label>
            <span>Volumen de datos</span>
            <select name="volumen" required>
              <option value="menos100">Menos de 100 GB</option>
              <option value="100a500">100–500 GB</option>
              <option value="500a2000">500 GB–2 TB</option>
              <option value="mas2000">Más de 2 TB</option>
            </select>
          </label>
          <label>
            <span>Número de equipos</span>
            <select name="equipos" required>
              <option value="1">1 equipo</option>
              <option value="2a5">2–5 equipos</option>
              <option value="6a10">6–10 equipos</option>
              <option value="mas10">Más de 10 equipos</option>
            </select>
          </label>
        </div>

        <label>
          <span>Proveedor preferido (opcional)</span>
          <input name="proveedor" placeholder="Google Drive, OneDrive, Dropbox, iCloud…">
        </label>

        <label>
          <span>Comentarios</span>
          <textarea name="detalle" rows="4" placeholder="Requisitos especiales, horarios, políticas internas…"></textarea>
        </label>

        <p class="help" id="estimado-ayuda">Estimado: —</p>
        <button class="btn primary" type="submit">Solicitar presupuesto</button>
      </form>
    </div>
    <div class="btn-center" style="margin-top:22px;">
      <a href="servicios.html" class="btn diagnostico">Volver</a>
    </div>
  </section>
</main>

<footer class="site-footer">
  <div class="container footer-grid">
    <div><strong>Data Recovery</strong><p>© <span id="year"></span></p></div>
    <nav aria-label="Secundario">
      <a href="index.html">Inicio</a>
      <a href="servicios.html" aria-current="page">Servicios</a>
      <a href="acerca.html">Acerca</a>
      <a href="contacto.html">Contacto</a>
    </nav>
  </div>
</footer>

<!-- Popup -->
<div class="popup-overlay" id="popup-overlay">
  <div class="popup">
    <h2>✅ ¡Solicitud enviada!</h2>
    <p>Gracias por contactarnos. Te enviaremos tu presupuesto pronto.</p>
    <button id="close-popup">Cerrar</button>
  </div>
</div>

<script>
  // Menú móvil
  const toggle=document.querySelector('.nav-toggle');
  const menu=document.getElementById('menu');
  toggle?.addEventListener('click',()=>{
    const e=toggle.getAttribute('aria-expanded')==='true';
    toggle.setAttribute('aria-expanded',String(!e));
    menu.classList.toggle('open');
  });
  document.getElementById('year').textContent=new Date().getFullYear();

  // Estimador (setup según volumen + ajuste por equipos)
  const form=document.getElementById('form-presu');
  const ayuda=document.getElementById('estimado-ayuda');

  const setupVolumen = {
    menos100:  [1200, 1600],
    "100a500": [1500, 2000],
    "500a2000":[1800, 2500],
    mas2000:   [2200, 3200]
  };
  const factorEquipos = {
    "1":     1.00,
    "2a5":   1.15,
    "6a10":  1.30,
    "mas10": 1.50
  };

  function calc(){
    const f=new FormData(form);
    const v=f.get('volumen'), e=f.get('equipos');
    if(setupVolumen[v] && factorEquipos[e]){
      const [min,max]=setupVolumen[v];
      const factor=factorEquipos[e];
      const minAdj=Math.round(min*factor), maxAdj=Math.round(max*factor);
      ayuda.textContent=`Estimado setup: $${minAdj.toLocaleString()}–$${maxAdj.toLocaleString()} MXN (orientativo) + mensualidad del proveedor.`;
    }
  }
  form?.addEventListener('change',calc);

  // Envío a Formspree + popup + honeypot + metadata de página
  const popupOverlay=document.getElementById('popup-overlay');
  const closePopup=document.getElementById('close-popup');

  form?.addEventListener('submit', async (ev)=>{
    ev.preventDefault();
    const data = new FormData(form);

    // Si el honeypot viene con texto, bloquear envío
    if ((data.get('campo_extra') || '').toString().trim() !== '') {
      return; // bot probable
    }

    // ---- Completar metadata útil antes de enviar ----
    // URL actual
    document.getElementById('page-url-field').value = window.location.href;

    // Subject bonito con selección + estimado
    const vol = data.get('volumen');
    const eq  = data.get('equipos');
    const est = (ayuda.textContent && ayuda.textContent.startsWith('Estimado'))
                ? ` | ${ayuda.textContent}` : '';
    const subject = `Solicitud: Respaldo en la nube (${vol}, ${eq})${est}`;
    document.getElementById('subject-field').value = subject;

    // Guardar el estimado de texto
    document.getElementById('estimado-field').value = ayuda.textContent || '';

    try {
      const response = await fetch(form.action, {
        method: form.method,
        body: data,
        headers: { 'Accept': 'application/json' }
      });
      if (response.ok) {
        popupOverlay.style.display='flex';
        form.reset();
        ayuda.textContent='Estimado: —';
      } else {
        alert("❌ Ocurrió un error al enviar el formulario. Inténtalo de nuevo.");
      }
    } catch (error) {
      alert("⚠️ No se pudo conectar con el servidor. Revisa tu conexión e intenta más tarde.");
    }
  });

  // Cerrar popup
  closePopup.addEventListener('click',()=>popupOverlay.style.display='none');
  popupOverlay.addEventListener('click',e=>{ if(e.target===popupOverlay) popupOverlay.style.display='none'; });
</script>
</body>
</html>
